window._pmConstants={MAXIMIZE_IFRAME:"CSPM_maximize_iframe_height",MINIMIZE_IFRAME:"CSPM_minimize_iframe_height",SAY_CLOSE_POPUP:"CSPM_close_popup_please",SAY_OPEN_ROOM:"CSPM_say_open_room",CLOSE_APPLICATION:"CSPM_close_application",TOGGLE_APPLICATION:"CSPM_toggle_application",CLOSE_POPUP_MESSAGE:"CSPM_close_popup_please",GET_PENDING_INVITATIONS:"get_pending_invitations",GET_PENDING_INVITATIONS_RESPONSE:"get_pending_invitations_response"};var app={};app.templates={};app.localStore=new localStore();app.postMessage=null;app.eventDispatcher={};_.extend(app.eventDispatcher,Backbone.Events);app.utils||(app.utils={});app.utils={__errorsStack:{__step:1,__min:1,__max:20},getParameterByName:function(c,d,b){b=b||window.location.href;c=c.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a=new RegExp("[\\?&]"+c+"=([^&#]*)").exec(b);return a===null?d:decodeURIComponent(a[1].replace(/\+/g," "))},getFBUserPic:function(a){return"https://graph.facebook.com/"+a+"/picture"},guidGenerator:function(){var a=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(a()+a()+a()+a())},htmlEntities:function(a){if(!a){return""}return $.trim(a.replace(/&(?!\w+;|#\d+;|#x[\da-f]+;)/gi,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;"))},firstToUppercase:function(a){if(!a||a.length===0){return false}return a.charAt(0).toUpperCase()+a.substr(1)},base64Support:function(c){if(!c){return undefined}var b=new Image();b.onload=function(){c(true)};b.onerror=function(){c(false)};var a="R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";while(a.length<33000){a="\r\n"+a}b.src="data:image/gif;base64,"+a},isMobile:function(){var b=navigator.userAgent||navigator.vendor||window.opera;return/android.+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(b)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(b.substr(0,4))},isIOS:function(){return !!navigator.userAgent.toLowerCase().match(/(iphone|ipod|ipad)/)},isIE:function(a){a=a||"";return navigator.userAgent.toLowerCase().indexOf("msie "+a)>0},is:function(a){return Object.prototype.toString.call(a).slice(8,-1)},deleteFromArray:function(b,c){var a=b.indexOf(c);delete b[a];b.splice(a,1);return b},compareArrays:function(f,e){if(f.length!==e.length){return false}var d=f.sort(),c=e.sort();for(var g=0;e[g];g++){if(d[g]!==c[g]){return false}}return true},replaceAll:function(b,a,c){while(b.indexOf(a)!==-1){b=b.replace(a,c)}return b},setISO8601:function(a,f){var b=/(\d\d\d\d)(-)?(\d\d)(-)?(\d\d)(T)?(\d\d)(:)?(\d\d)(:)?(\d\d)(\.\d+)?(Z|([+-])(\d\d)(:)?(\d\d))/;if(f.toString().match(new RegExp(b))){var e=f.match(new RegExp(b));var c=0;a.setUTCDate(1);a.setUTCFullYear(parseInt(e[1],10));a.setUTCMonth(parseInt(e[3],10)-1);a.setUTCDate(parseInt(e[5],10));a.setUTCHours(parseInt(e[7],10));a.setUTCMinutes(parseInt(e[9],10));a.setUTCSeconds(parseInt(e[11],10));if(e[12]){a.setUTCMilliseconds(parseFloat(e[12])*1000)}else{a.setUTCMilliseconds(0)}if(e[13]!="Z"){c=(e[15]*60)+parseInt(e[17],10);c*=((e[14]=="-")?-1:1);a.setTime(a.getTime()-c*60*1000)}}else{a.setTime(Date.parse(f))}return a},enablePlaceholder:function(){$("[placeholder]").focus(function(){var a=$(this);if(a.val()===a.attr("placeholder")){a.val("");a.removeClass("placeholder")}}).blur(function(){var a=$(this);if(a.val()===""||a.val()===a.attr("placeholder")){a.addClass("placeholder");a.val(a.attr("placeholder"))}}).blur()},insertParamToUrl:function(g,f,e){var d=this.parseUri(e||document.location.href);var i=d.query===""?"":"?"+d.query;var h=d.path===""?"/":d.path;var b=d.protocol+"://"+d.host+h;var c=g+"="+f;var a=new RegExp("(&|\\?)"+g+"=[^&]*");i=i.replace(a,"$1"+c);if(!i.match(a)){i+=(i.length>0?"&":"?")+c}return b+i},parseUri:function(e){var d={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};var a=d.parser[d.strictMode?"strict":"loose"].exec(e);var c={};var b=14;while(b--){c[d.key[b]]=a[b]||""}c[d.q.name]={};c[d.key[12]].replace(d.q.parser,function(g,f,h){if(f){c[d.q.name][f]=h}});return c},httpRequest:function(f,h,b,g,a){if(g==="jsonp"){$.getJSON(b,f,h);return false}var c=new XMLHttpRequest();c.open(g,b,true);if(navigator.userAgent.indexOf("Firefox/3.6")===-1&&c.setRequestHeader){try{c.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}catch(d){}}c.onreadystatechange=function(){if(c.readyState===4){function e(i,j){try{if(i==="json"){j=JSON.parse(j||"{}")}if(i==="xml"){j=$.parseXML(j||"<error>invalid data</error>")}}catch(k){}return j}if(h){h(e(a,c.responseText),c.status===200)}}};try{c.send(f)}catch(d){}return c},updateOnError:function(b,a){var c=this.__errorsStack;c[a]=c[a]||{current:c.__min,direction:"+"};if(c[a].direction==="+"){c[a].current++}if(c[a].direction==="-"){c[a].current--}if(c[a].current>c.__max){c[a].current--;c[a].direction="-"}if(c[a].current<c.__min){c[a].current++;c[a].direction="+"}setTimeout(b,c[a].current*1000)},makeLinkWithTarget:function(a,c,b){return'<a target="'+b+'" href="'+a+'">'+c+"</a>"},parseLinks:function(e){var a=this;var d=new RegExp("(http://|https://|www\\.)((\\d+\\.\\d+\\.\\d+\\.\\d+)|(\\S+\\.(zw|zm|za|yt|ye|xxx|ws|wf|vu|vn|vi|vg|ve|vc|va|uz|uy|us|uk|ug|ua|tz|tw|tv|tt|travel|tr|tp|to|tn|tm|tl|tk|tj|th|tg|tf|tel|td|tc|sz|sy|sv|su|st|sr|so|sn|sm|sl|sk|sj|si|sh|sg|se|sd|sc|sb|sa|rw|ru|rs|ro|re|qa|py|pw|pt|ps|pro|pr|pn|pm|pl|pk|ph|pg|pf|pe|pa|org|om|nz|nu|nr|np|no|nl|ni|ng|nf|net|ne|nc|name|na|mz|my|mx|mw|mv|museum|mu|mt|ms|mr|mq|mp|mobi|mo|mn|mm|ml|mk|mil|mh|mg|me|md|mc|ma|ly|lv|lu|lt|ls|lr|lk|li|lc|lb|la|kz|ky|kw|kr|kp|kn|km|ki|kh|kg|ke|jp|jobs|jo|jm|je|it|is|ir|iq|io|int|info|in|im|il|ie|id|hu|ht|hr|hn|hm|hk|gy|gw|gu|gt|gs|gr|gq|gp|gov|gn|gm|gl|gi|gh|gg|gf|ge|gd|gb|ga|fr|fo|fm|fk|fj|fi|eu|et|es|er|eg|ee|edu|ec|dz|do|dm|dk|dj|de|cz|cy|cx|cv|cu|cr|coop|com|co|cn|cm|cl|ck|ci|ch|cg|cf|cd|cc|cat|ca|bz|by|bw|bv|bt|bs|br|bo|bn|bm|bj|biz|bi|bh|bg|bf|be|bd|bb|ba|az|ax|aw|au|at|asia|as|arpa|ar|aq|ao|an|am|al|ai|ag|af|aero|ae|ad|ac)))(\\S*)*","ig");var c=e.match(d);var b=a.htmlEntities(e);if(c&&c.length>0){b="";$.each(c,function(g,j){var f=e.indexOf(j);var k=e.substring(0,f);var i;var h=i=a.htmlEntities(j);if(h.indexOf("www.")===0){h="http://"+i}if(k.length>0){b+=a.htmlEntities(k)}b+=" "+a.makeLinkWithTarget(h,i,"_blank");+" ";e=e.substring(f+j.length,e.length)});b+=a.htmlEntities(e)}return b},parseURL:function(b){var a=this;return b.replace(/[A-Za-z]+:\/\/[A-Za-z0-9-_]+\.[A-Za-z0-9-_:%&~\?\/.=]+/g,function(c){return a.makeLinkWithTarget(c,c,"_blank")})},parseUsername:function(b){var a=this;return b.replace(/[@]+[A-Za-z0-9-_]+/g,function(c){return a.makeLinkWithTarget("http://twitter.com/"+c.replace("@",""),c,"_blank")})},parseHashtag:function(b){var a=this;return b.replace(/[#]+[A-Za-z0-9-_]+/g,function(c){return a.makeLinkWithTarget("http://search.twitter.com/search?q="+c.replace("#","%23"),c,"_blank")})},parseTweet:function(a){return this.parseHashtag(this.parseUsername(this.parseURL(a)))},isEmptyObject:function(a){return JSON.stringify(a).length===2},dateFormat:function(b,f){var e="";var d={};d=$.extend(d,{shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],longMonths:["January","February","March","April","May","June","July","August","September","October","November","December"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longDays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]});d=$.extend(d,{d:function(){return(b.getDate()<10?"0":"")+b.getDate()},D:function(){return d.shortDays[b.getDay()]},j:function(){return b.getDate()},l:function(){return d.longDays[b.getDay()]},N:function(){return b.getDay()+1},S:function(){return(b.getDate()%10==1&&b.getDate()!=11?"st":(b.getDate()%10==2&&b.getDate()!=12?"nd":(b.getDate()%10==3&&b.getDate()!=13?"rd":"th")))},w:function(){return b.getDay()},z:function(){var g=new Date(b.getFullYear(),0,1);return Math.ceil((b-g)/86400000)},W:function(){var g=new Date(b.getFullYear(),0,1);return Math.ceil((((b-g)/86400000)+g.getDay()+1)/7)},F:function(){return d.longMonths[b.getMonth()]},m:function(){return(b.getMonth()<9?"0":"")+(b.getMonth()+1)},M:function(){return d.shortMonths[b.getMonth()]},n:function(){return b.getMonth()+1},t:function(){var g=new Date();return new Date(g.getFullYear(),g.getMonth(),0).getDate()},L:function(){var g=b.getFullYear();return(g%400==0||(g%100!=0&&g%4==0))},o:function(){var g=new Date(b.valueOf());g.setDate(g.getDate()-((b.getDay()+6)%7)+3);return g.getFullYear()},Y:function(){return b.getFullYear()},y:function(){return(""+b.getFullYear()).substr(2)},a:function(){return b.getHours()<12?"am":"pm"},A:function(){return b.getHours()<12?"AM":"PM"},B:function(){return Math.floor((((b.getUTCHours()+1)%24)+b.getUTCMinutes()/60+b.getUTCSeconds()/3600)*1000/24)},g:function(){return b.getHours()%12||12},G:function(){return b.getHours()},h:function(){return((b.getHours()%12||12)<10?"0":"")+(b.getHours()%12||12)},H:function(){return(b.getHours()<10?"0":"")+b.getHours()},i:function(){return(b.getMinutes()<10?"0":"")+b.getMinutes()},s:function(){return(b.getSeconds()<10?"0":"")+b.getSeconds()},u:function(){var g=b.getMilliseconds();return(g<10?"00":(g<100?"0":""))+g},e:function(){return"Not Yet Supported"},I:function(){return"Not Yet Supported"},O:function(){return(-b.getTimezoneOffset()<0?"-":"+")+(Math.abs(b.getTimezoneOffset()/60)<10?"0":"")+(Math.abs(b.getTimezoneOffset()/60))+"00"},P:function(){return(-b.getTimezoneOffset()<0?"-":"+")+(Math.abs(b.getTimezoneOffset()/60)<10?"0":"")+(Math.abs(b.getTimezoneOffset()/60))+":00"},T:function(){var h=b.getMonth();b.setMonth(0);var g=b.toTimeString().replace(/^.+ \(?([^\)]+)\)?$/,"$1");b.setMonth(h);return g},Z:function(){return -b.getTimezoneOffset()*60},c:function(){return b.format("Y-m-d\\TH:i:sP")},r:function(){return b.toString()},U:function(){return b.getTime()/1000}});for(var c=0;c<f.length;c++){var a=f.charAt(c);if(c-1>=0&&f.charAt(c-1)=="\\"){e+=a}else{if(d[a]){e+=d[a].call(b)}else{if(a!="\\"){e+=a}}}}return e},correctTime:function(a){return a.toString().length===1?"0"+a:a},isTouchDevice:function(){return !!("ontouchstart" in window)},isFlashSupported:function(){try{if(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")){return true}}catch(a){if(navigator.mimeTypes["application/x-shockwave-flash"]!=undefined){return true}}return false},cloneFunction:function(b,a){var c=function(){};c.prototype=a.prototype;var d=new c();for(var e in b.prototype){d[e]=b.prototype[e]}b.prototype=d;b.prototype.__parent=a.prototype},log:function(){function b(){var j=new Date(),f=[],i=j.getHours(),c=j.getMinutes(),g=j.getSeconds(),e=j.getMilliseconds();f.push(((i%12||12)<10?"0":"")+(i%12||12));f.push((c<10?"0":"")+c);f.push((g<10?"0":"")+g);f.push((e<10?"00":(e<100?"0":""))+e);return f.join(":")}var a=[];$.each(arguments,function(d,c){a.push(c)});console.log(b()+" >> "+a.join(", "))},timeout:function(){return{set:function(a,b){this.clear();this.timeout=setTimeout(a,b||0);this.active=true},isActive:function(){return this.active},clear:function(){clearTimeout(this.timeout);this.active=false}}},Base64:{_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(c){var a="";var k,h,f,j,g,e,d;var b=0;c=this._utf8_encode(c);while(b<c.length){k=c.charCodeAt(b++);h=c.charCodeAt(b++);f=c.charCodeAt(b++);j=k>>2;g=((k&3)<<4)|(h>>4);e=((h&15)<<2)|(f>>6);d=f&63;if(isNaN(h)){e=d=64}else{if(isNaN(f)){d=64}}a=a+this._keyStr.charAt(j)+this._keyStr.charAt(g)+this._keyStr.charAt(e)+this._keyStr.charAt(d)}return a},decode:function(c){var a="";var k,h,f;var j,g,e,d;var b=0;c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(b<c.length){j=this._keyStr.indexOf(c.charAt(b++));g=this._keyStr.indexOf(c.charAt(b++));e=this._keyStr.indexOf(c.charAt(b++));d=this._keyStr.indexOf(c.charAt(b++));k=(j<<2)|(g>>4);h=((g&15)<<4)|(e>>2);f=((e&3)<<6)|d;a=a+String.fromCharCode(k);if(e!=64){a=a+String.fromCharCode(h)}if(d!=64){a=a+String.fromCharCode(f)}}a=this._utf8_decode(a);return a},_utf8_encode:function(b){b=b.replace(/\r\n/g,"\n");var a="";for(var e=0;e<b.length;e++){var d=b.charCodeAt(e);if(d<128){a+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128)}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128)}}}return a},_utf8_decode:function(a){var b="";var d=0;var e=c1=c2=0;while(d<a.length){e=a.charCodeAt(d);if(e<128){b+=String.fromCharCode(e);d++}else{if((e>191)&&(e<224)){c2=a.charCodeAt(d+1);b+=String.fromCharCode(((e&31)<<6)|(c2&63));d+=2}else{c2=a.charCodeAt(d+1);c3=a.charCodeAt(d+2);b+=String.fromCharCode(((e&15)<<12)|((c2&63)<<6)|(c3&63));d+=3}}}return b}},__indexOf:(function(){Array.prototype.indexOf=function(b){var a=this.length>>>0,c=Number(arguments[1])||0;c=(c<0)?Math.ceil(c):Math.floor(c);if(c<0){c+=a}for(;c<a;c++){if(c in this&&this[c]===b){return c}}return -1}}()),__safeConsoleLog:(function(){(function(f){function e(){}for(var h="assert,count,deploy,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profileEnd,time,timeEnd,trace,warn".split(","),g;!!(g=h.pop());){f[g]=f[g]||e}})(function(){try{console.log();return window.console}catch(b){return(window.console={})}}())}())};app.globals={uuid:app.utils.getParameterByName("uuid",null),type:app.utils.getParameterByName("type",null),activities:(function(){try{return JSON.parse(app.utils.getParameterByName("activities","{}"))}catch(a){return{}}}())};app.constants={MAXIMIZE_IFRAME:"maximize_iframe_height",MINIMIZE_IFRAME:"minimize_iframe_height",CLOSE_POPUP_MESSAGE:"close_popup_please",SAY_OPEN_ROOM:"say_open_room",CANCEL_INVITATION:"cancel_invitation",ACCEPT_INVITATION:"accept_invitation",DEFAULT_THUMB_URL:"assets/images/defaultAvatar.png",ACTIVITY_PIXELS_PER_SECOND:30,SHOW_REQUESTS_ON_PAGE:3,UPDATE:{NOTIFICATIONS:30,SESSION_TIME:30},REQUESTS:{INVITE:1,FOLLOW:2},NOTIFICATION_TYPES:{GENERAL:"General",INVITE_TO_ROOM:"RoomInvite",REMOVE_INVITE_TO_ROOM:"RemoveRoomInvite",PRIVATE_INVITE:"PrivateInvite"},OBJECT_TYPES:{USER:"USER",ROOM:"ROOM"},JOIN_ROOM_TEXT:"joinRoomPlease"};app.events={API_CALL:"api_call",API_CALL_QUEUE:"api_call_queue",ABORT_API_CONNECTION:"abort_api_connection",USER_BANNED:"user_banned",ACCEPT:{FOLLOW_REQUEST:"accept_follow_request"},DECLINE:{FOLLOW_REQUEST:"decline_follow_request",INVITE:"decline_invite"},REMOVE_NOTIFICATIONS:"remove_notifications",JOIN_ROOM:"join_room",RECEIVE_POST_MESSAGE:"post_message_has_been_received"};app.router||(app.router={});app.router.ClipsyncApplication=Backbone.Router.extend({routes:{"*actions":"index"},initialize:function(){this.initPostMessage();app.clipsync.ClipsyncController();app.notifications.NotificationsController()},index:function(){},initPostMessage:function(){app.postMessage=new Porthole.WindowProxy();app.postMessage.addEventListener(function(a){if(a.data){app.eventDispatcher.trigger(app.events.RECEIVE_POST_MESSAGE,a)}})}});$(function(){app._router=new app.router.ClipsyncApplication();Backbone.history.start()});app.templates.activityTemplate=_.template('<div class="activity-item" data-id="<% notificationId %>"> 	<span class="clickable-element username" data-id="<%= userID %>"> 		<%= _.escape(username) %> 	</span> 	<%= _.escape(message) %> </div>');app.templates.followRequestsTemplate=_.template('<div id="follow-list-viewport" class="alert-box customized-scrollbar-dark"> 	<div class="customScrollBox"> 		<div class="container"> 			<div class="requests-list follow content"> 				<% _.each(requests, function(request) { %> 				<div class="requests-item follow" data-id="<%= request.id %>"> 					<img class="requests-thumb follow" src="<%= request.get(\'thumbURL\') %>" alt="" /> 					<div class="requests-text follow"> 						<span class="clickable-element username" data-id="<%= request.get(\'userID\') %>"> 							<%= _.escape(request.get(\'username\')) %> 						</span> 						wants to follow you 					</div> 					<div class="requests-buttons follow"> 						<span class="requests-button-accept follow">Accept</span> 						<span class="requests-button-decline follow">Decline</span> 					</div> 					<div class="clear"></div> 				</div> 				<% }) %> 			</div> 		</div> 		<div class="dragger_container"> 			<div class="dragger"> 				<div class="scrollThumb"></div> 			</div> 		</div> 	</div> </div> <div class="requests-arrow"></div> <div class="requests-close">x</div>');app.templates.inviteRequestsTemplate=_.template('<div id="invites-list-viewport" class="alert-box customized-scrollbar-dark"> 	<div class="customScrollBox"> 		<div class="container"> 			<div class="requests-list invite content"> 				<% _.each(requests, function(request) { %> 					<div class="requests-item invite" data-id="<%= request.id %>"> 						<img class="requests-thumb invite" src="<%= request.get(\'thumbURL\') %>" alt="" /> 						<div class="requests-text invite"> 							<span class="clickable-element username" data-id="<%= request.get(\'userID\') %>"> 								<%= _.escape(request.get(\'username\')) %> 							</span> 							<%                                 if(request.get(\'type\') === \'PrivateInvite\') print(\'invited you to join 1:1 chat\');                                 else print(\'invited you to join the chatroom \' + _.escape(request.get(\'roomname\')));                             %> 						</div> 						<div class="requests-buttons invite"> 							<span class="requests-button-accept invite">Accept</span> 							<span class="requests-button-decline invite">Decline</span> 						</div> 						<div class="clear"></div> 					</div> 				<% }) %> 			</div> 		</div> 		<div class="dragger_container"> 			<div class="dragger"> 				<div class="scrollThumb"></div> 			</div> 		</div> 	</div> </div> <div class="requests-arrow"></div> <div class="requests-close">x</div>');app.templates.notificationBarTemplate=_.template('<% if (app.globals.activities.feed) { %> 	<div id="activity"> 		<div class="activity-list"></div> 	</div> 	<div id="toggle"> 		<span class="sprite toggle-icon"></span> 	</div> <% } %>  <div id="notifications"> 	<% if (app.globals.activities.invites) { %> 		<div id="notifications-invite"> 			<span class="notifications-icon notifications-invite-icon"></span> 			<span class="notifications-count notifications-invite-count"></span> 		</div> 	<% } %> 	<% if (app.globals.activities.requests) { %> 		<div id="notifications-follow"> 			<span class="notifications-icon notifications-follow-icon"></span> 			<span class="notifications-count notifications-follow-count"></span> 		</div> 	<% } %> </div>');app.clipsync||(app.clipsync={});app.clipsync.ApiModel=Backbone.Model.extend({defaults:{methodType:"post",dataType:"json",url:null,constants:null,sid:null,connections:{}},queue:{start:null,stack:[],executeAfter:200,maxWait:250,timeout:new app.utils.timeout()},initialize:function(){_.bindAll(this);app.eventDispatcher.on(app.events.API_CALL,this.call);app.eventDispatcher.on(app.events.API_CALL_QUEUE,this.callInQueue);app.eventDispatcher.on(app.events.ABORT_API_CONNECTION,this.abort)},callInQueue:function(d,b,c){if(this.queue.timeout.isActive()){var a=((new Date()).getTime()-this.queue.start)>(this.queue.maxWait-this.queue.executeAfter);if(a){this.executeQueue()}else{this.queue.stack.push([d,b,c])}}else{this.queue.start=(new Date()).getTime();this.queue.stack.push([d,b,c]);this.queue.timeout.set(this.executeQueue,this.queue.executeAfter)}},executeQueue:function(){var e=this.queue.stack.length;if(e===1){var b=this.queue.stack[0];this.call(b[0],b[1],b[2])}else{if(e>1){var f=[];var d=[];var a=this.get("sid");var c=app.localStore.get("userID");_.each(this.queue.stack,function(h,g){f[g]||(f[g]={});if(g===0){f[g]["sid"]=a;f[g]["customerID"]=c}f[g]["method"]=h[0];f[g]["args"]=h[1];d[g]=h[2]});this.call(f,null,d,true)}}this.clearQueue()},clearQueue:function(){this.queue.start=null;this.queue.stack=[];this.queue.timeout.clear()},call:function(a,g,h,e){var f=this,b=undefined,i=f.attributes.connections,d=a;if(i[d]==="aborted"){_.delay(f.call,100,a,g,h);return false}var c=function(k,j,m){var l=function(){var n=false;n=k.fault.indexOf(f.get("constants").USER_ID_BLOCKED)===0||n;n=k.fault.indexOf(f.get("constants").USER_IP_BLOCKED)===0||n;if(n){var o=$.trim(k.fault.slice(k.fault.indexOf(":")+1));app.eventDispatcher.trigger(app.events.USER_BANNED,o)}return n};if(e&&j&&!(m>=0)){_.each(k,function(o,n){c(o,j,n)});return false}if(k&&k.fault&&l()){return false}if(j){if(_.isFunction(h)){h(k,j)}else{if(_.isArray(h)&&(m>=0)&&_.isFunction(h[m])){h[m](k,j)}}}else{_.defer(function(){var n=i[d]==="aborted";delete f.attributes.connections[d];if(!n){app.utils.updateOnError(function(){f.call(a,g,h)},a)}})}};if(_.isArray(a)&&!e){d=[];_.each(a,function(k,j){a[j]["sid"]=f.get("sid");a[j]["customerID"]=app.localStore.get("userID");if(_.isString(k.method)){d.push(k.method)}});b=a;d=d.join("_")}else{if(e){d=[];_.each(a,function(k,j){if(_.isString(k.method)){d.push(k.method)}});b=a;d=d.join("_")}else{b={sid:f.get("sid"),method:a,args:g};b.customerID=app.localStore.get("userID")}}i[d]=app.utils.httpRequest(JSON.stringify(b),c,f.get("url"),f.get("methodType"),f.get("dataType"))},abort:function(b){var a=this.attributes.connections[b];if(a==="aborted"){var c=this;_.delay(c.abort,100,b)}else{if(a){a.abort();this.attributes.connections[b]="aborted"}}}});app.clipsync||(app.clipsync={});app.clipsync.ConfigModel=Backbone.Model.extend({defaults:{sid:"5c09286115fb4bed9e60f0b0fd5408d4",url:"http://"+app.utils.getParameterByName("s","api")+".clipsync.com/api",proxyURL:"http://"+app.utils.getParameterByName("s","api")+".clipsync.com/getUrl.aspx?url="}});app.clipsync||(app.clipsync={});app.clipsync.ConstantsModel=Backbone.Model.extend({defaults:{USER_ID_BLOCKED:"UserID Blocked:",USER_IP_BLOCKED:"IP Blocked:",USER_EJECTED:"User Ejected:"}});app.clipsync||(app.clipsync={});app.clipsync.ClipsyncController=function(e){var a;var f;var b;var d;(function c(g){a=g;b=new app.clipsync.ConfigModel().toJSON();d=new app.clipsync.ConstantsModel().toJSON();f=new app.clipsync.ApiModel({constants:d,url:b.url,sid:b.sid})}(e));return{config:b}};app._super||(app._super={});app._super.ScrollerView=Backbone.View.extend({$_viewport:null,$_container:".container",$_draggerContainer:".dragger_container",$_dragger:".dragger",initCustomScroll:function(h,b){$(this.$_viewport).mCustomScrollbar("vertical",0,"easeOutCirc",1,"auto","yes");if((h&&h.containerTop)||b){var e=this.$el.find(this.$_viewport+" "+this.$_dragger),g=this.$el.find(this.$_viewport+" "+this.$_container),d=g.height(),a=e.height(),f,c;if(b){f=$(this.$_viewport).height()-d;c=$(this.$_viewport+" "+this.$_draggerContainer).height()-a}else{f=h.containerTop-(d-h.containerHeight);c=h.draggerTop+(h.draggerHeight-a)}g.css("top",f<0?f:0);e.css("top",c>0?c:0)}},getCurrentOffset:function(a){var e=this.$el.find(this.$_viewport+" "+this.$_container);var c=this.$el.find(this.$_viewport+" "+this.$_dragger);var b={containerTop:parseInt(e.css("top"),10)||0,containerHeight:e.height()||0,draggerTop:parseInt(c.css("top"),10)||0,draggerHeight:c.height()||0};if(b.containerTop===0){b.draggerTop=0}if(a){if(b.containerTop===0){var d=$(this.$_viewport).height()-b.containerHeight;if(d<0){b.containerTop=d}}if(b.draggerTop===0){b.draggerTop=$(this.$_viewport+" "+this.$_draggerContainer).height()-b.draggerHeight}}return b}});app.notifications||(app.notifications={});app.notifications.RequestsCollection=Backbone.Collection.extend({initialize:function(){_.bindAll(this);this.on("add",this.fixUsername)},addFollowRequests:function(b){if(!b||!b.length){return false}var a=this;_.each(b,function(c){c.type=app.constants.REQUESTS.FOLLOW;c.id=c.userID;c.thumbURL=c.thumbURL||app.constants.DEFAULT_THUMB_URL;if(c.id&&!a.get(c.id)){a.add(c)}});return true},addInvites:function(a){var c=this,b=this;_.each(a,function(f){f.id=f.roomID;f.thumbURL=f.thumbURL||app.constants.DEFAULT_THUMB_URL;var e=c.get(f.id),d=f.type===app.constants.REMOVE_INVITE_TO_ROOM,h=f.correct===true,g=[];if(d||!h){g.push(f.notificationId);if(e){g.push(e.get("notificationId"));c.remove(e)}}else{if(e){g.push(f.notificationId)}}if(g.length){app.eventDispatcher.trigger(app.events.REMOVE_NOTIFICATIONS,g);return false}if(h){c.add(f)}});return true},parseInvite:function(a){try{return JSON.parse(a)}catch(b){return false}},getParams:function(c){var a=false,d=false,b=[];if(c){d=c.match(/({{\S+?}})+/ig)}if(!d){return false}_.each(d,function(e){e=e.slice(2,-2).split("#");if(e[0]&&e[1]){b.push(e)}});return b},getFollowRequests:function(){return this.where({type:app.constants.REQUESTS.FOLLOW})},getInviteRequests:function(){return _.filter(this.models,function(a){return a.get("type")===app.constants.NOTIFICATION_TYPES.INVITE_TO_ROOM||a.get("type")===app.constants.NOTIFICATION_TYPES.PRIVATE_INVITE})},getFollowRequestsCount:function(){return this.getFollowRequests().length},getInviteRequestsCount:function(){return this.getInviteRequests().length}});app.notifications||(app.notifications={});app.notifications.UserModel=Backbone.Model.extend({defaults:{},validate:function(a){if(!a.username){return"username is empty"}if(!a.userID){return"userID is empty"}},initialize:function(){_.bindAll(this)}});app.notifications||(app.notifications={});app.notifications.NotificationsView=app._super.ScrollerView.extend({el:"#notification-bar",$activity:"#activity",$alert:"#alert",$toggle:"#toggle",$close:".requests-close",$follow:"#notifications-follow",$invite:"#notifications-invite",$item:".requests-item",$list:".requests-list",$followItem:".requests-item.follow",$inviteItem:".requests-item.invite",$inviteCount:".notifications-invite-count",$followCount:".notifications-follow-count",$acceptFollower:".requests-button-accept.follow",$declineFollower:".requests-button-decline.follow",$acceptInvite:".requests-button-accept.invite",$declineInvite:".requests-button-decline.invite",$activityList:".activity-list",$arrow:".requests-arrow",$_viewport:null,$follow_viewport:"#follow-list-viewport",$invites_viewport:"#invites-list-viewport",template:app.templates.notificationBarTemplate,activityTemplate:app.templates.activityTemplate,followRequestsTemplate:app.templates.followRequestsTemplate,inviteRequestsTemplate:app.templates.inviteRequestsTemplate,active:false,queue:[],notificationBarSizes:{widthWithoutFeed:76,widthWithMinimizedFeed:98},initialize:function(a){_.bindAll(this);this.collection=a.collection;this.collection.on("add",this.updateRequests);this.collection.on("remove",this.updateRequestsAfterDelete);this.$el.on("click",this.$toggle,this.toggle).on("click",this.$follow,this.showFollowRequests).on("click",this.$invite,this.showInviteRequests);$(this.$alert).on("click",this.$acceptFollower,this.acceptFollowRequest).on("click",this.$declineFollower,this.declineFollowRequest).on("click",this.$acceptInvite,this.acceptInviteRequest).on("click",this.$declineInvite,this.declineInviteRequest).on("click",this.$close,this.closeAlert)},stopPropagation:function(a){a.stopPropagation()},alertHandler:function(b){var a=b?"on":"off";$(document)[a]("click",this.closeAlert);$(this.$alert)[a]("click",this.stopPropagation)},closeAlert:function(){this.alertHandler(false);$(this.$alert).removeAttr("data-id").empty();app.postMessage.post(window._pmConstants.MINIMIZE_IFRAME)},toggle:function(){var a=this.$el.hasClass("hidden")?"100%":this.notificationBarSizes.widthWithMinimizedFeed;this.$el.stop(true,true).animate({width:a},300).toggleClass("hidden")},updateRequests:function(c){var b=c.get("type"),a=$(this.$alert).attr("data-id")===b;switch(b){case app.constants.REQUESTS.FOLLOW:if(a){this.showFollowRequests(true)}this.updateFollowRequestsCount();break;case app.constants.NOTIFICATION_TYPES.INVITE_TO_ROOM:case app.constants.NOTIFICATION_TYPES.PRIVATE_INVITE:if(a){this.showInviteRequests(true)}this.updateInviteRequestsCount();break}},updateRequestsAfterDelete:function(d){var c,a=d.get("type"),e=d.id,b,f;switch(a){case app.constants.REQUESTS.INVITE:c=this.$inviteItem;b=this.collection.getInviteRequestsCount();f=this.updateInviteRequestsCount;break;case app.constants.REQUESTS.FOLLOW:c=this.$followItem;b=this.collection.getFollowRequestsCount();f=this.updateFollowRequestsCount;break}if(c){this.removeRequests(c,e,a,b,f)}},removeRequests:function(e,f,b,d,g){var a=$(e+"[data-id="+f+"]"),c=+$(this.$alert).attr("data-id")===b;if(c){this.animateRemove(a,d)}g()},updateRequestsCount:function(a,b){a.text(b).stop(true,true)[b?"fadeIn":"fadeOut"](300)},updateInviteRequestsCount:function(){this.updateRequestsCount($(this.$inviteCount),this.collection.getInviteRequestsCount())},updateFollowRequestsCount:function(){this.updateRequestsCount($(this.$followCount),this.collection.getFollowRequestsCount())},showRequests:function(a){var d=$(this.$alert);if(!a.update&&+d.attr("data-id")===a.id){this.closeAlert();return false}var c=this,b=a.list.length;if(!b){return false}_.defer(function(){var e=c.getCurrentOffset();d.attr("data-id",a.id).html(a.template({requests:a.list.reverse()}));_.defer(function(){if(a.right){$(c.$arrow).css("right",a.right)}var i=$(c.$item).hide(),h=i.first().show(),f;_(app.constants.SHOW_REQUESTS_ON_PAGE-1).times(function(){h=h.next().show()});f=$(c.$list).height();if(b>app.constants.SHOW_REQUESTS_ON_PAGE){f-=10}d.css("height",f);i.show();c.initCustomScroll(e);if(!a.update){var g=c.$el.height()+f+30;app.postMessage.post({type:window._pmConstants.MAXIMIZE_IFRAME,data:{height:g}})}});if(!a.update){c.alertHandler(true)}})},showInviteRequests:function(b){var a=$(this.$invite);this.$_viewport=this.$invites_viewport;this.showRequests({id:app.constants.REQUESTS.INVITE,list:this.collection.getInviteRequests(),template:this.inviteRequestsTemplate,update:b&&_.isBoolean(b),right:$("body").width()-a.offset().left-a.width()+1})},showFollowRequests:function(b){var a=$(this.$follow);this.$_viewport=this.$follow_viewport;this.showRequests({id:app.constants.REQUESTS.FOLLOW,list:this.collection.getFollowRequests(),template:this.followRequestsTemplate,update:b&&_.isBoolean(b),right:$("body").width()-a.offset().left-a.width()+1})},animateRemove:function(a,c){var d=this.getCurrentOffset(),b=this;a.slideUp(function(){$(this).remove();b.initCustomScroll(d);if(!c){$(document).click()}})},changeFollowRequest:function(f,a){var d=$(f.currentTarget).parents(this.$followItem),g=d.attr("data-id"),c=a?"ACCEPT":"DECLINE";if(g){var b=this.collection.get(g);app.eventDispatcher.trigger(app.events[c].FOLLOW_REQUEST,g);this.collection.remove(b);this.animateRemove(d,this.collection.getFollowRequestsCount());this.updateRequestsAfterDelete(b);this.updateFollowRequestsCount()}},changeInviteRequest:function(d,a){var c=$(d.currentTarget).parents(this.$inviteItem),f=c.attr("data-id");if(f){var b=this.collection.get(f);if(!a){app.eventDispatcher.trigger(app.events.DECLINE.INVITE,f)}app.eventDispatcher.trigger(app.events.REMOVE_NOTIFICATIONS,[b.get("notificationId")]);this.collection.remove(b,{silent:true});this.animateRemove(c,this.collection.getInviteRequestsCount());this.updateRequestsAfterDelete(b);this.updateInviteRequestsCount()}},acceptFollowRequest:function(a){this.changeFollowRequest(a,true)},declineFollowRequest:function(a){this.changeFollowRequest(a,false)},acceptInviteRequest:function(a){this.changeInviteRequest(a,true);var b=$(a.currentTarget).parents(this.$inviteItem).attr("data-id");if(b){app.eventDispatcher.trigger(app.events.JOIN_ROOM,b)}},declineInviteRequest:function(a){this.changeInviteRequest(a,false)},showActivities:function(a){if(this.active){this.queue=this.queue.concat(a);return false}this.active=true;this.queue=[];var g=$(this.$activityList),f=$(this.$activity),e=f.width(),d=[],h=this.activityTemplate,j=this,i=function(){j.repeat(a)};_.each(a,function(k){d.push(h(k))});g.html(d.join("")).css("marginLeft",e);f.addClass("fix");var b=g.width(),c=(b<e?e:b)/app.constants.ACTIVITY_PIXELS_PER_SECOND*1000;f.removeClass("fix");g.animate({marginLeft:-b},c,"linear",i)},repeat:function(a){this.active=false;this.showActivities(this.queue.length?this.queue:a)},render:function(){var a=app.globals.activities.feed?$(window).width():this.notificationBarSizes.widthWithoutFeed;this.$el.html(this.template()).css("width",a)}});app.notifications||(app.notifications={});app.notifications.NotificationsController=function(z){var B,A=null,b=-1,n=app.globals.activities,v,r,d;(function x(E){B=E||{};v=new app.notifications.RequestsCollection();r=new app.notifications.NotificationsView({collection:v});d=new app.notifications.UserModel();r.render();app.eventDispatcher.on(app.events.ACCEPT.FOLLOW_REQUEST,k);app.eventDispatcher.on(app.events.DECLINE.FOLLOW_REQUEST,g);app.eventDispatcher.on(app.events.DECLINE.INVITE,c);app.eventDispatcher.on(app.events.REMOVE_NOTIFICATIONS,j);app.eventDispatcher.on(app.events.JOIN_ROOM,s);app.eventDispatcher.on(app.events.RECEIVE_POST_MESSAGE,p);app.localStore.set("userID",app.globals.uuid);l()}(z));function m(){if(n.requests){f()}if(n.feed||n.invites){w()}}function w(){app.eventDispatcher.trigger(app.events.API_CALL_QUEUE,"getNotifications",[null,A],o)}function f(){app.eventDispatcher.trigger(app.events.API_CALL_QUEUE,"getRequests",null,a)}function o(E){_.delay(w,app.constants.UPDATE.NOTIFICATIONS*1000);if(!E.result||!_.isArray(E.result)||!E.result.length){return false}var F=[],G=[];_.each(E.result,function(H){if(H.notificationId&&H.notificationId>=b){b=H.notificationId;A=H.date}switch(H.type){case app.constants.NOTIFICATION_TYPES.GENERAL:if(n.feed){G.push(H)}break;case app.constants.NOTIFICATION_TYPES.INVITE_TO_ROOM:case app.constants.NOTIFICATION_TYPES.REMOVE_INVITE_TO_ROOM:case app.constants.NOTIFICATION_TYPES.PRIVATE_INVITE:if(n.invites){F.push(H)}break}});if(F.length){t(F)}if(G.length){e(G)}}function e(E){_.each(E,function(G){var F=G.message.match(/{{\S+}}/g);if(!F||!F.length){return}G.objects=[];_.each(F,function(H,I){var K=H.slice(2,-2).split("#"),J=K[1].split(":");G.objects.push({index:G.message.indexOf(H),type:K[0],name:app.utils.Base64.decode(J[0]),id:app.utils.Base64.decode(J[1])});G.message=G.message.replace(H,G.objects[I].name)})});r.showActivities(E)}function t(F){var E={},G={};_.each(F,function(H){var I=v.parseInvite(H.message);if(I&&I[1]){H.roomname=I[0];H.roomID=I[1]}if(H.type===app.constants.NOTIFICATION_TYPES.PRIVATE_INVITE){G[H.roomID]=H}else{E[H.roomID]=H}D(E);C(G)})}function D(E){if(!E){return false}app.eventDispatcher.trigger(app.events.API_CALL,"getRoomsByIDs",[_.keys(E)],function(F){if(F&&F.result&&F.result.length){_.each(F.result,function(G){if(G&&G.roomID in E){E[G.roomID].correct=true}})}v.addInvites(_.values(E))})}function C(E){if(!E){return false}q(E,y)}function q(F,E){app.eventDispatcher.on("pendingInvitesReceived",function(H){app.eventDispatcher.off("pendingInvitesReceived",arguments.callee);for(var G in F){if(H.indexOf(G)>=0){delete F[G]}}E.apply(this,[F])});app.postMessage.post(window._pmConstants.GET_PENDING_INVITATIONS)}function y(F){var E=_.keys(F);if(!E||!E.length){return false}app.eventDispatcher.trigger(app.events.API_CALL,"getOnline",[E],function(G){if(G&&G.result&&G.result.length){_.each(G.result,function(H){F[H].correct=true})}v.addInvites(_.values(F))})}function a(E){_.delay(f,app.constants.UPDATE.NOTIFICATIONS*1000);if(!E.result||!_.isArray(E.result)||!E.result.length){return false}v.addFollowRequests(E.result)}function l(){app.eventDispatcher.trigger(app.events.API_CALL,"syncUserInfo",null,function(E){if(E.result){i(E)}})}function i(E){if(E.result){d.set(E.result);app.localStore.set("userID",d.get("userID"));m()}}function h(){app.eventDispatcher.trigger(app.events.API_CALL_QUEUE,"updateUserSession",[d.get("_userSession")],function(E){_.delay(h,app.constants.UPDATE.SESSION_TIME*1000);if(E.result){d.set("_userSession",E.result)}})}function k(E){if(E){app.eventDispatcher.trigger(app.events.API_CALL_QUEUE,"acceptFollow",E)}}function g(E){if(E){app.eventDispatcher.trigger(app.events.API_CALL_QUEUE,"declineFollow",E)}}function c(E){if(E){app.eventDispatcher.trigger(app.events.API_CALL_QUEUE,"cancelMembership",E)}}function j(E){if(!_.isArray(E)||!E.length){return false}_.each(E,function(F){app.eventDispatcher.trigger(app.events.API_CALL_QUEUE,"removeNotification",F)})}function s(E){app.postMessage.post({type:window._pmConstants.SAY_OPEN_ROOM,data:{id:E}})}function p(F){var E=F.data,G=[];if(app.utils.is(E)==="Object"){G=E.data.params||G;E=E.data.type}switch(E){case window._pmConstants.SAY_CLOSE_POPUP:r.closeAlert();break;case app.constants.CLOSE_POPUP_MESSAGE:r.closeAlert();break;case app.constants.CANCEL_INVITATION:case app.constants.ACCEPT_INVITATION:u.apply(this,G);break;case window._pmConstants.GET_PENDING_INVITATIONS_RESPONSE:app.eventDispatcher.trigger("pendingInvitesReceived",G);break;default:break}}function u(F){var J=v.getInviteRequests(),I=J?J.length:0,E,H=[];for(var G=0;G<I;G++){E=J[G];if(E&&E.get("userID")===F){H.push(E.get("notificationId"));v.remove(E)}}j(H)}};